The program initializes ans as the numbers 1..(n+1) instead of the required range 1..(2n+1), so it omits many legal moves.
