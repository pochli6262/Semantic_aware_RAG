The code never reduces the accumulated dp values modulo 998244353 (it only takes %mod on the summands), so the dp entries and the final printed answer are not properly taken modulo.
