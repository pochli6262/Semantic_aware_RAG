The code mistakenly uses 2 ** A[i] (raising 2 to the bit value) instead of 2 ** i, so it computes A[i]*2^{A[i]} rather than A[i]*2^{i}.
