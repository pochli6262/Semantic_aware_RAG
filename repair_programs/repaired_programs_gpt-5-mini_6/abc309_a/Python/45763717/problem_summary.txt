The code mistakenly treats numbers with difference 3 as horizontally adjacent by checking abs(a-b) in [1,3] instead of requiring abs(a-b) == 1.
