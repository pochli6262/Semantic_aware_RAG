The code wrongly treats w == N as invalid (checks w >= N), so it rejects valid solutions where the third segment ends at the end of the array.
