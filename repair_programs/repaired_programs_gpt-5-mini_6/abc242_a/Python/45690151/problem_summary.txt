The code uses b-a+1 as the denominator when computing the random-selection probability instead of b-a, causing an off-by-one error in that probability.
