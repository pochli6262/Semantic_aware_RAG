The code mixes a modular pow with an unmodded (M-1) and never reduces the final sum modulo 998244353, so the output can be negative or incorrect modulo.
