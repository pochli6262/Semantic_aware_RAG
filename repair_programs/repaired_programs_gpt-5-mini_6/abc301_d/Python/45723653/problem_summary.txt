The code fills '?' bits from the least significant to the most significant (wrong order), so it can miss larger valid numbers and fail to produce the maximal value â‰¤ N.
