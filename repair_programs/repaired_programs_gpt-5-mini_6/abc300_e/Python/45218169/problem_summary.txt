The factorization loop uses floating-point division (curN /= p) instead of integer division, causing curN and factors to be computed incorrectly.
