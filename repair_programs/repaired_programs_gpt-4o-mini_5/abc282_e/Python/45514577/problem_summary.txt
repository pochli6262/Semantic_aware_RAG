The likely bug is that the program sums the scores of edges in a union-find structure, rather than calculating the maximum score by properly simulating the game rules for choosing and removing balls.
