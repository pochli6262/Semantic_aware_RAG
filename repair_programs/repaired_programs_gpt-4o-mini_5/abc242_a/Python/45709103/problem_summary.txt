The bug likely lies in the incorrect handling of the ranking condition since it incorrectly calculates the total participants eligible for selection between ranks A+1 and B by using `b-a` instead of the correct range.
