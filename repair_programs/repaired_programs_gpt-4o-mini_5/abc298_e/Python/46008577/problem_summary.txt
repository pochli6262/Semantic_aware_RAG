The likely bug is that the program incorrectly calculates the transition probabilities for the states in the dynamic programming table, especially when updating the win probabilities after taking turns.
