The likely bug is that the program does not handle the maximum value of N correctly for the range of each truncation condition.
