The likely bug is that the program does not correctly handle the case where `?` could produce values greater than `N` due to incorrect bit manipulation logic.
