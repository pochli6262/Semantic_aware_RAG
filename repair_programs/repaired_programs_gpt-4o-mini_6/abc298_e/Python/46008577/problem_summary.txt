The likely bug is that the program incorrectly handles the probability calculations, particularly in the way it computes the contribution of each player's moves to the dynamic programming table.
