The bug lies in the improper use of the logical condition for checking specific grid configurations, which results in incorrect output for some valid cases.
