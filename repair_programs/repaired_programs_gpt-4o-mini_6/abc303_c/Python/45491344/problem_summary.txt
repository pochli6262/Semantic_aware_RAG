The likely bug is that the item consumption logic incorrectly uses the equality operator instead of the assignment operator when trying to mark the item as consumed, resulting in the item not being removed from the map.
