The likely bug is that the program mistakenly uses `a - d` instead of `c - d` in the calculation.
