The likely bug is that the inner loop incorrectly breaks when `i` equals `j`, instead of continuing to check all combinations of distinct indices.
