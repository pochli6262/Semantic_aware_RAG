The likely bug is that the last condition incorrectly handles the input range for N values between 10^8 and 10^9-1, as it applies the truncation rule for 10^7 instead of the intended rule for 10^8.
