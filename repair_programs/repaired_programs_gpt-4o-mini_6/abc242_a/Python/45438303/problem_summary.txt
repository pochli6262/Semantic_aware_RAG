The likely bug is that the program incorrectly computes the probability for participants ranked between (A+1) and B by using the total range (B-A) instead of the actual number of participants in that range.
