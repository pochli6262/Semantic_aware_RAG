The likely bug is that the program incorrectly calculates the probability for participants ranked between A+1 and B, as it fails to account for the total number of participants in that range when ranking isn't guaranteed.
