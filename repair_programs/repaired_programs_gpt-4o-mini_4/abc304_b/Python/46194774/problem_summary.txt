The bug likely lies in the last conditional check, as it does not handle the case where N is exactly 10^8.
