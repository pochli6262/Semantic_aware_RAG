The program computes the coupon option as P - Q + d instead of the correct Q + d, so it uses the wrong expression for the discounted total.
