The code incorrectly uses the parity of the number of positions that differ (Hamming distance) instead of the parity of the permutation (inversion parity) between S and T.
