The code initializes the available moves as 1..n+1 (range(1, n+2)) instead of the required 1..2*n+1, so it doesn't include all valid numbers.
