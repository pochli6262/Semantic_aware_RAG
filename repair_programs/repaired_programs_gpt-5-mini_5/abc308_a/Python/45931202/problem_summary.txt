The code uses >= when checking order, so it wrongly rejects non-decreasing sequences that contain equal adjacent values (it should allow S[i] == S[i+1]).
