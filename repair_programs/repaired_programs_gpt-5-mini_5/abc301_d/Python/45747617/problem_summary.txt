The program wrongly strips leading '0' characters from S (shortening its length and shifting bit positions), which changes the intended set of binary values and yields incorrect results when S starts with zeros.
