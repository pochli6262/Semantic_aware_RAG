The start-index calculation wrongly applies max before the division (missing parentheses), so when l-k-1 is negative the computed prefix index is incorrect and yields wrong sums.
