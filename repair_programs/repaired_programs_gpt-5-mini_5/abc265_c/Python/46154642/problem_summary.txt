The condition for moving right mistakenly checks for the character "W" instead of "R", so rightward moves are never handled.
